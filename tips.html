<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tipping & Requests - Lance Woolie</title>
    <link href="https://fonts.googleapis.com/css2?family=Georgia&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Georgia', serif; 
            max-width: 800px; 
            margin: 0 auto; 
            padding: 10px; 
            background-color: #1e3a8a; /* Dark royal blue */
            color: #E0E0E0; /* Light grey text */
        }
        h1, h2 { 
            text-align: center; 
            color: #FFD700; /* Gold */
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        button { 
            padding: 10px 20px; 
            margin: 5px; 
            background: #0074D9; /* Blue */
            color: #E0E0E0; /* Light grey */
            border: 2px solid #0074D9; 
            border-radius: 5px; 
            cursor: pointer; 
            font-size: 16px; 
            font-weight: bold;
            transition: all 0.3s ease;
        }
        button:hover { 
            background: #FFD700; /* Gold on hover */
            color: #001f3f; /* Dark blue text */
            border-color: #FFD700;
            transform: scale(1.05);
        }
        #tip-section, #custom-section { 
            background: linear-gradient(rgba(0, 31, 63, 0.8), rgba(30, 58, 138, 0.8)); 
            padding: 15px; 
            margin: 10px 0; 
            border: 2px solid #0074D9; 
            border-radius: 15px; 
            box-shadow: 0 4px 15px rgba(0, 116, 217, 0.3);
        }
        #tip-section button { 
            background: #FFD700; /* Gold for quick tips */
            color: #001f3f; /* Dark blue text */
            border: 2px solid #FFD700;
        }
        #tip-section button:hover { 
            background: #e6c200; 
            border-color: #e6c200; 
            color: #001f3f;
        }
        #tip-section .free-suggestion {
            background: #FFD700; /* Yellow for suggestion */
            color: #001f3f;
            border: 2px solid #FFD700;
        }
        #tip-section .free-suggestion:hover {
            background: #e6c200;
            border-color: #e6c200;
        }
        .custom-tip-row { 
            display: flex; 
            align-items: center; 
            gap: 10px; 
            margin-top: 10px; 
        }
        .custom-tip-row input { 
            flex: 1; 
            min-width: 100px; 
            background: #001f3f; 
            color: #E0E0E0; 
            border: 1px solid #0074D9; 
        }
        input, textarea { 
            width: 100%; 
            padding: 10px; 
            margin: 5px 0; 
            border: 2px solid #0074D9; 
            border-radius: 5px; 
            box-sizing: border-box; 
            background: #001f3f; 
            color: #E0E0E0;
        }
        input::placeholder, textarea::placeholder {
            color: #808080; /* Grey placeholder */
        }
        #cart-icon { 
            position: fixed; 
            top: 10px; 
            right: 10px; 
            background: linear-gradient(45deg, #FFD700, #e6c200); 
            color: #001f3f; 
            padding: 10px; 
            border-radius: 50px; 
            font-weight: bold; 
            cursor: pointer; 
            border: 2px solid #FFD700;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }
        details { 
            margin: 10px 0; 
            border: 2px solid #0074D9; 
            border-radius: 15px; 
            overflow: hidden;
        }
        details summary { 
            padding: 10px; 
            background: #0074D9; /* Blue */
            color: #E0E0E0; 
            cursor: pointer; 
            border-radius: 5px; 
            font-weight: bold; 
        }
        details ul { 
            list-style: none; 
            padding: 0; 
            margin: 0; 
            background: #1e3a8a;
        }
        details li { 
            padding: 10px; 
            background: #001f3f; 
            margin: 5px 0; 
            cursor: pointer; 
            border-radius: 5px; 
            border: 1px solid #0074D9; 
            display: flex; 
            align-items: center; 
            color: #E0E0E0;
        }
        details li:hover { 
            background: #FFD700; 
            color: #001f3f; 
            border-color: #FFD700;
        }
        .song-icon { 
            margin-right: 8px; 
            font-size: 20px; 
        }
        #artists-section { 
            margin: 20px 0; 
        }
        #cart-section { 
            display: none; 
            background: linear-gradient(rgba(0, 31, 63, 0.8), rgba(30, 58, 138, 0.8)); 
            padding: 20px; 
            margin: 20px 0; 
            border: 2px solid #0074D9; 
            border-radius: 15px; 
            box-shadow: 0 4px 15px rgba(0, 116, 217, 0.3);
            color: #E0E0E0;
        }
        #cart-items li { 
            padding: 10px; 
            border-bottom: 1px solid #0074D9; 
            position: relative; 
            background: #001f3f; 
            border-radius: 5px;
            color: #E0E0E0;
        }
        .remove-btn { 
            color: #FF4500; /* Red-orange */
            cursor: pointer; 
            font-size: 18px; 
            position: absolute; 
            right: 10px; 
            top: 50%; 
            transform: translateY(-50%); 
        }
        .roundup-section { 
            margin: 10px 0; 
            color: #E0E0E0;
        }
        .roundup-section input[type="checkbox"] { 
            margin-right: 10px; 
        }
        #thankyou { 
            display: none; 
            text-align: center; 
            background: linear-gradient(rgba(0, 31, 63, 0.8), rgba(30, 58, 138, 0.8)); 
            padding: 20px; 
            border: 2px solid #0074D9; 
            border-radius: 15px; 
            color: #E0E0E0; 
            box-shadow: 0 4px 15px rgba(0, 116, 217, 0.3);
        }
        #paypal-button-container { 
            margin: 20px 0; 
        }
    </style>
    <!-- PayPal SDK -->
    <script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_CLIENT_ID&currency=USD"></script>
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-database-compat.js"></script>
    <!-- EmailJS -->
    <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
</head>
<body>
    <h1>Tipping & Requests</h1>
    <div id="cart-icon" onclick="showCart()">üõí (<span id="cart-count">0</span>)</div>
    
    <div id="tip-section">
        <h2>Quick Tip or Suggestion</h2>
        <button onclick="addTip(2)">$2 Tip</button>
        <button onclick="addTip(5)">$5 Tip</button>
        <button onclick="addTip(15)">$15 Tip</button>
        <button onclick="addTip(20)">$20 Tip</button>
        <button class="free-suggestion" onclick="freeSuggestion()">Free Suggestion</button>
        <div class="custom-tip-row">
            <input id="custom-tip" type="number" min="0" step="1" placeholder="Custom Tip Amount">
            <button onclick="addCustomTip()">Add Custom Tip</button>
        </div>
    </div>

    <button onclick="showCart()">View Song Cue (Cart)</button>

    <h2>Song Requests by Artist</h2>
    <div id="artists-section">
        <!-- Artists will load here -->
    </div>

    <div id="custom-section">
        <h2>Custom Song Request (Not Listed?)</h2>
        <input id="custom-song" placeholder='"Artist Name (Led Zeplin) -Song Name (Stairway To Heaven)"'>
        <button onclick="addCustomSong()">Add $20 Custom Song Request</button>
    </div>

    <div id="cart-section">
        <h2>Your Song Cue</h2>
        <ul id="cart-items"></ul>
        <p><strong>Total: $<span id="total">0</span></p>
        <div class="roundup-section">
            <label><input type="checkbox" id="roundup" onchange="toggleRoundup()"> Round up to next $10 (pay more!)</label>
        </div>
        <form id="checkout-form">
            <input name="Fan Name" placeholder="(audience member name, IE Tex Hooper)" required>
            <textarea name="message" placeholder="Custom Message to the Band (optional, e.g. 'Epstein didn't kill himself!')"></textarea>
            <input name="email" type="email" placeholder="Email Address" required>
            <div id="paypal-button-container"></div>
            <button type="submit">Submit to Live Cue</button>
        </form>
    </div>

    <div id="thankyou">
        <h2>Thank You!</h2>
        <p>Your request is queued. Rock on! üé∏</p>
        <button onclick="location.reload()">Start Over</button>
    </div>

    <script>
        // REPLACE THESE WITH YOUR VALUES
        const firebaseConfig = { /* Paste your config from contact.html here, e.g. { apiKey: "...", ... } */ };
        const EMAILJS_USER_ID = 'YOUR_EMAILJS_USER_ID';
        const EMAILJS_SERVICE_ID = 'service_n08jdhv';
        const EMAILJS_TEMPLATE_ID = 'YOUR_EMAILJS_TEMPLATE_ID';
        const EMAIL_TO = 'lancewoolie@gmail.com';

        // Songs Data (prices hidden: A=50, B=25, C=15, D=10, E=5; icons per song)
        const songsData = {"Aaron Watson":{"songs":["July In Cheyenne"],"prices":{"July In Cheyenne":"E"},"icons":{"July In Cheyenne":"ü™ï"}},"Alabama":{"songs":["Dixieland Delight","My Homes In Alabama"],"prices":{"Dixieland Delight":"E","My Homes In Alabama":"E"},"icons":{"Dixieland Delight":"ü™ï","My Homes In Alabama":"ü™ï"}},"Alan Jackson":{"songs":["Midnight in Montgomery","Dont Rock The Jukebox","Chatahooche"],"prices":{"Midnight in Montgomery":"E","Dont Rock The Jukebox":"E","Chatahooche":"E"},"icons":{"Midnight in Montgomery":"ü™ï","Dont Rock The Jukebox":"ü™ï","Chatahooche":"ü™ï"}},"Alice in Chains":{"songs":["Nutshell","Man in The Box"],"prices":{"Nutshell":"E","Man in The Box":"E"},"icons":{"Nutshell":"üé∏","Man in The Box":"üé∏"}},"Andrea Bocelli":{"songs":["Canciones Desinfindada","B√©same"],"prices":{"Canciones Desinfindada":"E","B√©same":"E"},"icons":{"Canciones Desinfindada":"üé∏","B√©same":"üé∏"}},"Anybody You Choose":{"songs":["Happy Birthday Song","Improv song about an audience member"],"prices":{"Happy Birthday Song":"B","Improv song about an audience member":"A"},"icons":{"Happy Birthday Song":"üéÇ","Improv song about an audience member":"ü§£"}},"Bad Religion":{"songs":["Whispers In Time","Man With a Mission","To Another Abyss"],"prices":{"Whispers In Time":"E","Man With a Mission":"E","To Another Abyss":"E"},"icons":{"Whispers In Time":"üé∏","Man With a Mission":"üé∏","To Another Abyss":"üé∏"}},"Blackberry Smoke":{"songs":["1 Horse Town","Up The Road","I've Got This Song"],"prices":{"1 Horse Town":"E","Up The Road":"E","I've Got This Song":"E"},"icons":{"1 Horse Town":"ü™ï","Up The Road":"ü™ï","I've Got This Song":"ü™ï"}},"Brooks & Dunn":{"songs":["Brand New Man","Neon Moon"],"prices":{"Brand New Man":"E","Neon Moon":"E"},"icons":{"Brand New Man":"ü™ï","Neon Moon":"ü™ï"}},"Charley Pride":{"songs":["Kiss An Angel Good Mornin","Is anybody Going to San Antone"],"prices":{"Kiss An Angel Good Mornin":"E","Is anybody Going to San Antone":"E"},"icons":{"Kiss An Angel Good Mornin":"ü™ï","Is anybody Going to San Antone":"ü™ï"}},"Charlie Crockett":{"songs":["Just Like Honey","just a Clown"],"prices":{"Just Like Honey":"E","just a Clown":"E"},"icons":{"Just Like Honey":"ü™ï","just a Clown":"ü™ï"}},"Chris Isaak":{"songs":["Wicked Game"],"prices":{"Wicked Game":"E"},"icons":{"Wicked Game":"üé∏"}},"Conway Twitty":{"songs":["I Don't Know A Thing About Love","Tight Fitting Jeans"],"prices":{"I Don't Know A Thing About Love":"E","Tight Fitting Jeans":"E"},"icons":{"I Don't Know A Thing About Love":"ü™ï","Tight Fitting Jeans":"ü™ï"}},"David Allan Coe":{"songs":["The Ride","Never Called Me By My Name"],"prices":{"The Ride":"E","Never Called Me By My Name":"E"},"icons":{"The Ride":"ü™ï","Never Called Me By My Name":"ü™ï"}},"Dixie Chicks":{"songs":["Wide Open Spaces","You Were Mine"],"prices":{"Wide Open Spaces":"E","You Were Mine":"E"},"icons":{"Wide Open Spaces":"ü™ï","You Were Mine":"ü™ï"}},"Dwight Yoakam":{"songs":["Honkey Tonk Man","Guitars Cadillac's"],"prices":{"Honkey Tonk Man":"E","Guitars Cadillac's":"E"},"icons":{"Honkey Tonk Man":"ü™ï","Guitars Cadillac's":"ü™ï"}},"Elvis Presley":{"songs":["I Can't Help Falling In Love with You","That's Alright Mama"],"prices":{"I Can't Help Falling In Love with You":"E","That's Alright Mama":"E"},"icons":{"I Can't Help Falling In Love with You":"üé∏","That's Alright Mama":"üé∏"}},"Garth Brooks":{"songs":["Thunder Rolls","The Dance","Low Places"],"prices":{"Thunder Rolls":"E","The Dance":"E","Low Places":"C"},"icons":{"Thunder Rolls":"ü™ï","The Dance":"ü™ï","Low Places":"ü™ï"}},"George Jones":{"songs":["The Good Times Ain't Over","Who's Gonna Fill Those Shoes"],"prices":{"The Good Times Ain't Over":"E","Who's Gonna Fill Those Shoes":"E"},"icons":{"The Good Times Ain't Over":"ü™ï","Who's Gonna Fill Those Shoes":"ü™ï"}},"George Strait":{"songs":["Marina Del Rey","All My Ex's Live In Texas","Amarillo By Morning","The Chair","Unwound","Nobody In His Right Mind"],"prices":{"Marina Del Rey":"E","All My Ex's Live In Texas":"E","Amarillo By Morning":"E","The Chair":"E","Unwound":"E","Nobody In His Right Mind":"E"},"icons":{"Marina Del Rey":"ü™ï","All My Ex's Live In Texas":"ü™ï","Amarillo By Morning":"ü™ï","The Chair":"ü™ï","Unwound":"ü™ï","Nobody In His Right Mind":"ü™ï"}},"Green Day":{"songs":["Good Riddance"],"prices":{"Good Riddance":"E"},"icons":{"Good Riddance":"üé∏"}},"Hank Williams Jr.":{"songs":["Family Tradition","Dinosaur","Whiskey Bent","Women I Never Had"],"prices":{"Family Tradition":"E","Dinosaur":"E","Whiskey Bent":"E","Women I Never Had":"E"},"icons":{"Family Tradition":"ü™ï","Dinosaur":"ü™ï","Whiskey Bent":"ü™ï","Women I Never Had":"ü™ï"}},"Hank Williams Sr.":{"songs":["Jambalaya","Buckets Got A Hole In It","Your Cheatin Heart"],"prices":{"Jambalaya":"E","Buckets Got A Hole In It":"E","Your Cheatin Heart":"E"},"icons":{"Jambalaya":"ü™ï","Buckets Got A Hole In It":"ü™ï","Your Cheatin Heart":"ü™ï"}},"Hogleg Band":{"songs":["How It Feels To Be Cowboy","Road To Texas","My Dog Still Loves Me","1 of Us Is Wrong"],"prices":{"How It Feels To Be Cowboy":"D","Road To Texas":"D","My Dog Still Loves Me":"D","1 of Us Is Wrong":"D"},"icons":{"How It Feels To Be Cowboy":"ü™ï","Road To Texas":"ü™ï","My Dog Still Loves Me":"ü™ï","1 of Us Is Wrong":"ü™ï"}},"James Taylor":{"songs":["Sweet Baby James"],"prices":{"Sweet Baby James":"E"},"icons":{"Sweet Baby James":"üé∏"}},"Jamey Johnson":{"songs":["In Color"],"prices":{"In Color":"E"},"icons":{"In Color":"ü™ï"}},"Jimi Hendrix":{"songs":["Wind Cries Mary","Red House","Little Wing"],"prices":{"Wind Cries Mary":"E","Red House":"E","Little Wing":"E"},"icons":{"Wind Cries Mary":"üé∏","Red House":"üé∏","Little Wing":"üé∏"}},"Jimmy Buffett":{"songs":["Margaritaville"],"prices":{"Margaritaville":"E"},"icons":{"Margaritaville":"ü™ï"}},"John Anderson":{"songs":["Black Sheep","Chuck Of Coal"],"prices":{"Black Sheep":"E","Chuck Of Coal":"E"},"icons":{"Black Sheep":"ü™ï","Chuck Of Coal":"ü™ï"}},"John Denver":{"songs":["Country Roads"],"prices":{"Country Roads":"E"},"icons":{"Country Roads":"ü™ï"}},"Johnny Cash":{"songs":["Ring Of Fire","Folsom Prison Blues","Hurt"],"prices":{"Ring Of Fire":"E","Folsom Prison Blues":"E","Hurt":"E"},"icons":{"Ring Of Fire":"ü™ï","Folsom Prison Blues":"ü™ï","Hurt":"üé∏"}},"Kenny Rogers":{"songs":["Lady","Islands in the Stream (duet)"],"prices":{"Lady":"E","Islands in the Stream (duet)":"E"},"icons":{"Lady":"ü™ï","Islands in the Stream (duet)":"ü™ï"}},"Keith Whitley":{"songs":["Honkey Tonk Heart","No Stranger To The Rain","Don't Close Your Eyes","I Wonder Do You Think Of Me"],"prices":{"Honkey Tonk Heart":"E","No Stranger To The Rain":"E","Don't Close Your Eyes":"E","I Wonder Do You Think Of Me":"E"},"icons":{"Honkey Tonk Heart":"ü™ï","No Stranger To The Rain":"ü™ï","Don't Close Your Eyes":"ü™ï","I Wonder Do You Think Of Me":"ü™ï"}},"Lance":{"songs":["Custom Happy Birthday Tribute Song"],"prices":{"Custom Happy Birthday Tribute Song":"B"},"icons":{"Custom Happy Birthday Tribute Song":"üéÇ"}},"Lance Woolie":{"songs":["Too Drunk","Worst Enemy","Uber","How It Feels To Be a Cowboy","Road To Texas","Crazy Arms","Back Home","TRUST","One of Us is Wrong"],"prices":{"Too Drunk":"E","Worst Enemy":"E","Uber":"E","How It Feels To Be a Cowboy":"E","Road To Texas":"E","Crazy Arms":"E","Back Home":"E","TRUST":"E","One of Us is Wrong":"E"},"icons":{"Too Drunk":"ü™ï","Worst Enemy":"ü™ï","Uber":"ü™ï","How It Feels To Be a Cowboy":"ü™ï","Road To Texas":"ü™ï","Crazy Arms":"ü™ï","Back Home":"ü™ï","TRUST":"ü™ï","One of Us is Wrong":"ü™ï"}},"Lee Greenwood":{"songs":["God Bless The USA"],"prices":{"God Bless The USA":"A"},"icons":{"God Bless The USA":"ü™ï"}},"Little Feat":{"songs":["Willin"],"prices":{"Willin":"E"},"icons":{"Willin":"üé∏"}},"Lynn Anderson":{"songs":["Rose Garden"],"prices":{"Rose Garden":"E"},"icons":{"Rose Garden":"ü™ï"}},"Lynyrd Skynyrd":{"songs":["Simple Man","Free Bird","Sweet Home Alabama"],"prices":{"Simple Man":"E","Free Bird":"A","Sweet Home Alabama":"E"},"icons":{"Simple Man":"üé∏","Free Bird":"üé∏","Sweet Home Alabama":"üé∏"}},"Merle Haggard":{"songs":["That's The Way Love Goes","Big City","Working Man Blues","I Just Stay Here and Drink"],"prices":{"That's The Way Love Goes":"E","Big City":"E","Working Man Blues":"E","I Just Stay Here and Drink":"E"},"icons":{"That's The Way Love Goes":"ü™ï","Big City":"ü™ï","Working Man Blues":"ü™ï","I Just Stay Here and Drink":"ü™ï"}},"Michael Jackson":{"songs":["I Want You Back"],"prices":{"I Want You Back":"E"},"icons":{"I Want You Back":"üé∏"}},"Midland":{"songs":["Drinking Problem"],"prices":{"Drinking Problem":"E"},"icons":{"Drinking Problem":"ü™ï"}},"Nirvana":{"songs":["Man Who Sold The World","All Apologies"],"prices":{"Man Who Sold The World":"E","All Apologies":"E"},"icons":{"Man Who Sold The World":"üé∏","All Apologies":"üé∏"}},"Parker McCollum":{"songs":["Pretty Heart"],"prices":{"Pretty Heart":"E"},"icons":{"Pretty Heart":"ü™ï"}},"Post Malone":{"songs":["Circles"],"prices":{"Circles":"E"},"icons":{"Circles":"üé∏"}},"Ray Wylie Hubbard":{"songs":["Snake Farm","Red Neck Mother"],"prices":{"Snake Farm":"E","Red Neck Mother":"B"},"icons":{"Snake Farm":"üé∏","Red Neck Mother":"ü§£"}},"REM":{"songs":["Losing My Religion"],"prices":{"Losing My Religion":"E"},"icons":{"Losing My Religion":"üé∏"}},"Randy Travis":{"songs":["Forever & Ever Amen","Digging Up Bones","I Told You So"],"prices":{"Forever & Ever Amen":"E","Digging Up Bones":"E","I Told You So":"E"},"icons":{"Forever & Ever Amen":"ü™ï","Digging Up Bones":"ü™ï","I Told You So":"ü™ï"}},"Rodney Carrington":{"songs":["Dear Penis"],"prices":{"Dear Penis":"B"},"icons":{"Dear Penis":"ü§£"}},"Ricky Skaggs":{"songs":["Heartbroke","Country Boy","Highway 40 Blues"],"prices":{"Heartbroke":"E","Country Boy":"E","Highway 40 Blues":"E"},"icons":{"Heartbroke":"ü™ï","Country Boy":"ü™ï","Highway 40 Blues":"ü™ï"}},"Rolling Stones":{"songs":["Wild Horses","Angel"],"prices":{"Wild Horses":"E","Angel":"E"},"icons":{"Wild Horses":"üé∏","Angel":"üé∏"}},"Ronnie Milsap":{"songs":["Stranger In My House","Smokey Mountain Rain","The Freeze"],"prices":{"Stranger In My House":"E","Smokey Mountain Rain":"E","The Freeze":"E"},"icons":{"Stranger In My House":"ü™ï","Smokey Mountain Rain":"ü™ï","The Freeze":"ü™ï"}},"Stevie Wonder":{"songs":["I Just Called To Say I Love You","Superstition"],"prices":{"I Just Called To Say I Love You":"E","Superstition":"E"},"icons":{"I Just Called To Say I Love You":"üé∏","Superstition":"üé∏"}},"Tex Hooper":{"songs":["Man Hole Inspector","Texas On A Saturday Night","Empty Bed"],"prices":{"Man Hole Inspector":"B","Texas On A Saturday Night":"B","Empty Bed":"B"},"icons":{"Man Hole Inspector":"ü§£","Texas On A Saturday Night":"ü§£","Empty Bed":"ü§£"}},"The Civil Wars":{"songs":["20 Years","Dance Me To The End Of Love"],"prices":{"20 Years":"E","Dance Me To The End Of Love":"E"},"icons":{"20 Years":"üé∏","Dance Me To The End Of Love":"üé∏"}},"The Eagles":{"songs":["Tequila Sunrise","Witchy Woman","Hotel California"],"prices":{"Tequila Sunrise":"E","Witchy Woman":"E","Hotel California":"E"},"icons":{"Tequila Sunrise":"üé∏","Witchy Woman":"üé∏","Hotel California":"üé∏"}},"The Highwaymen":{"songs":["Highwayman"],"prices":{"Highwayman":"E"},"icons":{"Highwayman":"ü™ï"}},"Tom Petty":{"songs":["Won't Back Down","You Got Lucky"],"prices":{"Won't Back Down":"E","You Got Lucky":"E"},"icons":{"Won't Back Down":"üé∏","You Got Lucky":"üé∏"}},"Tracy Lawrence":{"songs":["Time Marches On","Sticks And Stones"],"prices":{"Time Marches On":"E","Sticks And Stones":"E"},"icons":{"Time Marches On":"ü™ï","Sticks And Stones":"ü™ï"}},"Travis Tritt":{"songs":["Help Me Hold On"],"prices":{"Help Me Hold On":"E"},"icons":{"Help Me Hold On":"ü™ï"}},"Van Morrison":{"songs":["Moondance"],"prices":{"Moondance":"E"},"icons":{"Moondance":"üé∏"}},"Vince Gill":{"songs":["Tryin To Get Over You"],"prices":{"Tryin To Get Over You":"E"},"icons":{"Tryin To Get Over You":"ü™ï"}},"Waylon Jennings":{"songs":["Mamas Don't Let Your Babies","Luckenbach Texas"],"prices":{"Mamas Don't Let Your Babies":"E","Luckenbach Texas":"E"},"icons":{"Mamas Don't Let Your Babies":"ü™ï","Luckenbach Texas":"ü™ï"}},"Wheeler Walker Jr.":{"songs":["Fuck You Bitch","Drop Em Out"],"prices":{"Fuck You Bitch":"B","Drop Em Out":"B"},"icons":{"Fuck You Bitch":"ü§£","Drop Em Out":"ü§£"}},"Willie Nelson":{"songs":["Blue Eyes Crying","On The Road Again","City OF New Orleans"],"prices":{"Blue Eyes Crying":"E","On The Road Again":"E","City OF New Orleans":"E"},"icons":{"Blue Eyes Crying":"ü™ï","On The Road Again":"ü™ï","City OF New Orleans":"ü™ï"}},"Zach Top":{"songs":["Bad Luck","I Never Lie","Dirt To Gold","When You See Me","South of Sanity"],"prices":{"Bad Luck":"E","I Never Lie":"E","Dirt To Gold":"E","When You See Me":"E","South of Sanity":"E"},"icons":{"Bad Luck":"ü™ï","I Never Lie":"ü™ï","Dirt To Gold":"ü™ï","When You See Me":"ü™ï","South of Sanity":"ü™ï"}}};

        // Price map (hidden)
        const prices = {'A':50, 'B':25, 'C':15, 'D':10, 'E':5};

        // Cart (localStorage)
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let baseTotal = 0;
        let roundedTotal = 0;

        // Build artist accordion (alpha sorted)
        function buildArtists() {
            const sortedArtists = Object.keys(songsData).sort();
            let html = '';
            sortedArtists.forEach(artist => {
                html += `<details><summary>${artist}</summary><ul>`;
                songsData[artist].songs.forEach(song => {
                    const escapedArtist = artist.replace(/'/g, "\\'");
                    const escapedSong = song.replace(/'/g, "\\'");
                    const icon = songsData[artist].icons[song] || '';
                    let songDisplay = song;
                    if (artist === 'Anybody You Choose' && song === 'Happy Birthday Song') {
                        songDisplay += ' <strong>($25)</strong>';
                    }
                    html += `<li onclick="addSong('${escapedArtist}', '${escapedSong}')"><span class="song-icon">${icon}</span>${songDisplay}</li>`;
                });
                html += '</ul></details>';
            });
            document.getElementById('artists-section').innerHTML = html;
            console.log('Artists built:', sortedArtists.length); // Debug log
        }

        // Remove item from cart
        function removeItem(index) {
            cart.splice(index, 1);
            updateCart();
        }

        // Toggle roundup
        function toggleRoundup() {
            updateCart();
        }

        // Update cart display
        function updateCart() {
            localStorage.setItem('cart', JSON.stringify(cart));
            document.getElementById('cart-count').textContent = cart.length;
            let itemsHtml = '';
            baseTotal = 0;
            cart.forEach((item, index) => {
                let price = item.amount || prices[item.tier] || 0;
                baseTotal += price;
                let display = item.type === 'tip' ? `Tip: $${price}` : `${item.artist ? item.artist + ' - ' : ''}${item.song}`;
                itemsHtml += `<li>${display} ($${price}) <span class="remove-btn" onclick="removeItem(${index})">‚ùå</span></li>`;
            });
            document.getElementById('cart-items').innerHTML = itemsHtml;
            roundedTotal = Math.ceil(baseTotal / 10) * 10;
            const roundupChecked = document.getElementById('roundup').checked;
            document.getElementById('total').textContent = (roundupChecked ? roundedTotal : baseTotal).toFixed(2);
        }

        // Add song
        function addSong(artist, song) {
            const tier = songsData[artist].prices[song];
            cart.push({artist, song, tier});
            updateCart();
            alert('song added to cart! Check out now, or request multiple songs.');
            showCart();
        }

        // Add tip
        function addTip(amount) {
            cart.push({type: 'tip', amount});
            updateCart();
            alert('THANK YOU, tip added to cart');
            showCart();
        }

        // Free suggestion
        function freeSuggestion() {
            showCart();
            setTimeout(() => {
                document.querySelector('textarea[name="message"]').scrollIntoView({behavior: 'smooth'});
                document.querySelector('textarea[name="message"]').focus();
            }, 500);
        }

        // Add custom tip
        function addCustomTip() {
            const amt = parseFloat(document.getElementById('custom-tip').value) || 0;
            cart.push({type: 'tip', amount: amt});
            document.getElementById('custom-tip').value = '';
            updateCart();
            alert('THANK YOU, tip added to cart');
            showCart();
        }

        // Add custom song
        function addCustomSong() {
            const song = document.getElementById('custom-song').value.trim();
            if (song) {
                cart.push({song, amount: 20, custom: true});
                document.getElementById('custom-song').value = '';
                updateCart();
                alert(`${song} ($20) added to cue!`);
                showCart();
            } else {
                alert('Enter a song name!');
            }
        }

        // Show cart
        function showCart() {
            document.getElementById('cart-section').style.display = 'block';
            document.getElementById('cart-section').scrollIntoView({behavior: 'smooth'});
        }

        // Init Firebase after DOM
        function initFirebase() {
            if (firebaseConfig.apiKey) { // Only if config provided
                firebase.initializeApp(firebaseConfig);
                window.db = firebase.database().ref('signups');
            } else {
                console.warn('Firebase config missing - emails/signups will fail');
            }
        }

        // Init EmailJS
        function initEmailJS() {
            if (EMAILJS_USER_ID !== 'YOUR_EMAILJS_USER_ID') {
                emailjs.init(EMAILJS_USER_ID);
            } else {
                console.warn('EmailJS not configured - emails will fail');
            }
        }

        // Checkout
        document.getElementById('checkout-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const fanName = formData.get('Fan Name');
            const email = formData.get('email');
            const message = formData.get('message') || '';

            // Store to Firebase (Fan Name/email only) if available
            if (window.db) {
                window.db.push({
                    'Fan Name': fanName,
                    email,
                    timestamp: firebase.database.ServerValue.TIMESTAMP
                });
            }

            // Calc total
            const roundupChecked = document.getElementById('roundup').checked;
            const total = roundupChecked ? roundedTotal : baseTotal;

            // Build email body
            let body = `Tips & Requests from ${fanName} (${email})\n\nRequested Songs:\n`;
            cart.forEach(item => {
                if (item.type === 'tip') {
                    body += `- Tip: $${item.amount}\n`;
                } else {
                    body += `- ${item.artist ? item.artist + ' - ' : ''}${item.song} ($${item.amount || prices[item.tier] || 0})\n`;
                }
            });
            body += `\nMessage: ${message}\n\nTotal: $${total.toFixed(2)}`;

            if (total === 0) {
                // Free: Send email directly
                sendEmail(body, true); // Pass isFree flag
                showThankyou();
                return;
            }

            // PayPal - only render if not already
            if (!document.querySelector('#paypal-button-container script')) {
                paypal.Buttons({
                    createOrder: (data, actions) => actions.order.create({
                        purchase_units: [{ amount: { value: total.toFixed(2) } }]
                    }),
                    onApprove: async (data, actions) => {
                        await actions.order.capture();
                        sendEmail(body, false);
                        showThankyou();
                    },
                    onError: (err) => {
                        console.error('PayPal error:', err);
                        alert('Payment failed - try again or contact support');
                    }
                }).render('#paypal-button-container');
            }
        });

        // Send email
        function sendEmail(body, isFree = false) {
            if (EMAILJS_SERVICE_ID !== 'YOUR_EMAILJS_SERVICE_ID' && EMAILJS_TEMPLATE_ID !== 'YOUR_EMAILJS_TEMPLATE_ID' && EMAILJS_USER_ID !== 'YOUR_EMAILJS_USER_ID') {
                emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, {
                    to_email: EMAIL_TO,
                    message: body
                }).then(() => console.log('Email sent!'), (err) => {
                    console.error('Email failed:', err);
                    if (!isFree) {
                        alert('Request queued, but email notification failed - thanks anyway!');
                    }
                });
            } else {
                console.warn('Email not sent - config missing');
                if (!isFree) {
                    alert('Request queued, but email notification failed - thanks anyway!');
                }
            }
        }

        // Show thanks
        function showThankyou() {
            document.getElementById('cart-section').style.display = 'none';
            document.getElementById('thankyou').style.display = 'block';
            document.getElementById('thankyou').scrollIntoView({behavior: 'smooth'});
            cart = [];
            localStorage.removeItem('cart');
            updateCart();
        }

        // Init on load
        window.addEventListener('DOMContentLoaded', () => {
            buildArtists();
            initFirebase();
            initEmailJS();
            updateCart();
        });
    </script>
</body>
</html>
